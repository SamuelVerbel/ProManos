<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Registro Trabajador - ProManos</title>
	<link rel="stylesheet" href="/public/css/main.css">
	<link rel="stylesheet" href="/public/css/trabajador.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<script src="/public/js/auth.js"></script>
</head>
<body>
	<div class="container" style="min-height:100vh; display:flex; align-items:center; justify-content:center;">
		<div class="card" style="max-width:520px; width:100%;">
			<div class="text-center mb-3">
				<h2><i class="fas fa-user-plus"></i> Registro Trabajador</h2>
				<p>Crea tu perfil profesional</p>
			</div>

			<form id="registroForm">
				<div class="form-group">
					<label for="nombre" class="form-label">Nombre Completo</label>
					<input type="text" id="nombre" class="form-control" placeholder="Tu nombre completo" required>
				</div>

				<div class="form-group">
					<label for="email" class="form-label">Email</label>
					<input type="email" id="email" class="form-control" placeholder="tu@email.com" required>
				</div>

				<div class="form-group">
					<label for="telefono" class="form-label">Teléfono</label>
					<input type="tel" id="telefono" class="form-control" placeholder="3001234567" pattern="[0-9]{7,15}">
				</div>

				<div class="form-group">
					<label for="especialidad" class="form-label">Especialidad</label>
					<input type="text" id="especialidad" class="form-control" placeholder="Albañilería, Plomería..." required>
				</div>

				<div class="form-group">
					<label for="password" class="form-label">Contraseña</label>
					<div style="position: relative;">
						<input type="password" id="password" class="form-control" placeholder="Mínimo 6 caracteres" minlength="6" required>
						<span style="position: absolute; right: 15px; top: 50%; transform: translateY(-50%); cursor: pointer;" onclick="togglePassword('password')">
							<i class="fas fa-eye"></i>
						</span>
					</div>
				</div>

				<button type="submit" class="btn btn-primary" style="width:100%;">Crear cuenta</button>
			</form>

			<div class="text-center mt-3">
				<p>¿Ya tienes cuenta? <a href="login.html">Inicia sesión</a></p>
				<p><a href="/">← Volver al inicio</a></p>
			</div>

			<div id="mensaje"></div>
		</div>
	</div>

	<script>
		document.getElementById('registroForm').addEventListener('submit', async (e) => {
			e.preventDefault();

			const userData = {
				nombre: document.getElementById('nombre').value,
				email: document.getElementById('email').value,
				telefono: document.getElementById('telefono').value,
				especialidad: document.getElementById('especialidad').value,
				password: document.getElementById('password').value
			};

			const mensaje = document.getElementById('mensaje');
			const res = await authManager.register('trabajadores', userData);
			if (res.success) {
				mensaje.innerHTML = '<div class="alert alert-success">Cuenta creada. Redirigiendo al login...</div>';
				setTimeout(() => window.location.href = 'login.html', 1400);
			} else {
				mensaje.innerHTML = `<div class="alert alert-danger">${res.mensaje || 'Error'}</div>`;
			}
		});
	</script>
</body>
</html>
